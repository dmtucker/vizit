!function e(i,t,r){function o(a,l){if(!t[a]){if(!i[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=t[a]={exports:{}};i[a][0].call(u.exports,function(e){var t=i[a][1][e];return o(t?t:e)},u,u.exports,e,i,t,r)}return t[a].exports}for(var n="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e){var i=e("./visualizers/plain"),t=e("./visualizers/spatial"),r={canvas:document.getElementById("canvas"),data:null,supported_visualizations:["plain","spatial"],toggle:document.getElementById("toggle"),visualization:"plain"};window.Vizit={version:"0.1.0",error:function(e){throw null==e&&(e="An error occurred in Vizit."),console.error(e),alert(e),window.location.assign("//dmtucker.github.io/vizit/"),new Error(e)},nextVisualization:function(e){var i=r.supported_visualizations.indexOf(e)+1;return i==r.supported_visualizations.length&&(i=0),r.supported_visualizations[i]},visualize:function(e){switch(e=e.toLowerCase(),e.toLowerCase()){case"spatial":r.visualization="spatial",document.getElementById("version").style.visibility="hidden","undefined"!=typeof OpenFusion&&null!=r.data.OpenFusion&&OpenFusion.spatial.preprocessor(r.data),r.map=t.visualizer(r.data,r.canvas.id);break;case"plain":r.visualization="plain",document.getElementById("version").style.visibility="visible","undefined"!=typeof OpenFusion&&null!=r.data.OpenFusion&&OpenFusion.plain.preprocessor(r.data),i.visualizer(r.data,r.canvas.id);break;default:Vizit.error("Supported visualizations: "+r.supported_visualizations)}},unvisualize:function(){null!=r.map&&(r.map.remove(),r.map=null);var e=document.createElement("div");e.id=r.canvas.id,r.canvas.parentNode.insertBefore(e,r.canvas.nextSibling),r.canvas.parentElement.removeChild(r.canvas),r.canvas=e},visualizeNext:function(){var e=Vizit.nextVisualization(r.visualization);Vizit.unvisualize(),r.toggle.innerHTML=Vizit.nextVisualization(e),Vizit.visualize(e)},init:function(e,i,t,o){GeoJSON.isGeoJSON(e)?(r.data=e,r.canvas=document.getElementById(t),r.toggle=document.getElementById(o),r.toggle.addEventListener("click",Vizit.visualizeNext,!1),r.toggle.innerHTML=Vizit.nextVisualization(i),Vizit.visualize(i)):Vizit.error("Error: Only valid GeoJSON resources can be visualized!\n\nSee http://geojson.org/ for more information.")},features:function(e){var i=[];return GeoJSON.features(e).map(function(e){i.push(e),null!=e.properties&&GeoJSON.isFeatureCollection(e.properties.related)&&Vizit.features(e.properties.related).forEach(function(e){i.push(e)})}),i},HTMLFeature:function(e){var i="";if(null!=e.properties){var t=e.properties;if(null!=t.time){var r=new Date(t.time);i+='<time datetime="'+JSON.stringify(r)+'">'+r+"</time>"}null!=t.source&&(i+="<cite>"+t.source+"</cite>"),null!=t.text&&(i+="<blockquote>"+t.text+"</blockquote>"),null!=t.image&&(i+='<img src="data:image/jpeg;base64,'+t.image+'">')}return i}}},{"./visualizers/plain":2,"./visualizers/spatial":3}],2:[function(e,i,t){t.version="0.1.0",t.renderFeature=function(e){if(null!=e.properties){var i=document.createElement("article");return i.className="plain",i.innerHTML=Vizit.HTMLFeature(e),"string"==typeof e.properties.location?(i.innerHTML+="<address>"+e.properties.location+"</address>",canvas.appendChild(i)):"Point"===e.geometry.type?$.get("http://nominatim.openstreetmap.org/reverse?format=xml&lat="+e.geometry.coordinates[1].toString()+"&lon="+e.geometry.coordinates[0].toString()).done(function(t){e.properties.location=$(t).find("result").text(),i.innerHTML+="<address>"+e.properties.location+"</address>",canvas.appendChild(i)}).fail(function(e,i,t){console.error("Error: "+t)}):""!=i.innerHTML&&canvas.appendChild(i),i}},t.visualizer=function(e,i){var r={canvas:document.getElementById(i)};t.FeatureProcessor.bind(r),Vizit.features(e).map(function(e){var i=t.renderFeature(e);"undefined"!=typeof i&&(i.className+=GeoJSON.isFeatureCollection(e.properties.related)?" epicenter":" aftershock")})}},{}],3:[function(e,i,t){t.version="0.1.0",t.visualization=function(e){var i=L.map(e).setView([0,0],3);return L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{minZoom:0,maxZoom:24,maxNativeZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',tms:!1,continuousWorld:!1,noWrap:!0,zoomOffset:0,zoomReverse:!1,opactiy:1,zIndex:null,unloadInvisibleTiles:!1,updateWhenIdle:!1,detectRetina:!1,reuseTiles:!1,bounds:null}).addTo(i),i},t.FeatureStylist=function(e,i){if(null!=e.properties){var t=e.properties;if("Marker"===t.marker){var r={};return null!=t.markerOptions&&(r=t.markerOptions),L.marker(i,r)}if("CircleMarker"===t.marker){var o={};return null!=t.markerOptions&&(o=t.markerOptions),L.circleMarker(i,o)}}return L.marker(i)},t.GeoJSONStylist=function(e,i){if(null!=e.properties){var t=Vizit.HTMLFeature(e);""!==t&&i.bindPopup('<article class="popup">'+t+"</article>")}},t.FeatureProcessor=function(e,i,r){if(null!=r.geometry){if(null!=r.properties&&"number"==typeof r.properties.radius){var o={stroke:!0,color:"#000",weight:1,opacity:1,fill:!0,fillColor:"#fff",fillOpacity:.4,dashArray:null,lineCap:null,lineJoin:null,clickable:!0,pointerEvents:null,className:""};if(null!=r.properties.radiusOptions){var n=r.properties.radiusOptions;"boolean"==typeof n.stroke&&(o.stroke=n.stroke),"string"==typeof n.color&&(o.color=n.color),"number"==typeof n.weight&&(o.weight=n.weight),"number"==typeof n.opacity&&(o.opacity=n.opacity),"boolean"==typeof n.fill&&(o.fill=n.fill),"string"==typeof n.fillColor&&(o.fillColor=n.fillColor),"number"==typeof n.fillOpacity&&(o.fillOpacity=n.fillOpacity),"string"==typeof n.dashArray&&(o.dashArray=n.dashArray),"string"==typeof n.lineCap&&(o.lineCap=n.lineCap),"string"==typeof n.lineJoin&&(o.lineJoin=n.lineJoin),"boolean"==typeof n.clickable&&(o.clickable=n.clickable),"string"==typeof n.pointerEvents&&(o.pointerEvents=n.pointerEvents),"string"==typeof n.className&&(o.className=n.className)}L.circle([r.geometry.coordinates[1],r.geometry.coordinates[0]],r.properties.radius,o).addTo(e)}i.addData(r),GeoJSON.isFeatureCollection(r.properties.related)&&t.FeatureCollectionProcessor(e,i,r.properties.related)}},t.FeatureCollectionProcessor=function(e,i,r){r.features.forEach(function(r){t.FeatureProcessor(e,i,r)})},t.GeoJSONProcessor=function(e,i,r){GeoJSON.isFeature(r)?null!==r.geometry&&t.FeatureProcessor(e,i,r):GeoJSON.isFeatureCollection(r)?r.features.length>0&&t.FeatureCollectionProcessor(e,i,r):(!GeoJSON.isGeometryCollection(r)||r.geometries.length>0)&&i.addData(r)},t.visualizer=function(e,i){var r=t.visualization(i),o=L.geoJson(null,{pointToLayer:t.FeatureStylist,onEachFeature:t.GeoJSONStylist}).addTo(r);if(t.GeoJSONProcessor(r,o,e),o.getBounds().isValid()&&r.fitBounds(o),L.control.scale().addTo(r),GeoJSON.isFeatureCollection(e)&&e.features.length>1){var n=L.control.sliderControl({position:"topright",layer:o,range:!0});r.addControl(n),n.startSlider()}return r}},{}]},{},[1]);
